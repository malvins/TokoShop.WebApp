@page "/"
@page "/TokoShopWebApp"

<MudContainer Class="mt-8 px-8" MaxWidth="MaxWidth.False">
    <MudGrid>

        <MudItem xs="12" sm="8">
            <MudGrid>
                <MudItem xs="12">
                    <MudPaper Elevation="1" Class="pa-4">
                        <MudText><b>Sales Overview X</b></MudText>
                        <MudGrid Class="pt-3">
                            <MudItem xs="6" md="3">
                                <MudPaper Elevation="0" Class="d-flex flex-grow-1 gap-4">
                                    <MudImage Src="images/Sales.svg" Elevation="25" Width="32" Height="32" Alt="Swedish Farm House" Class="rounded-lg" />
                                    <MudPaper Elevation="0" Class="flex-initial d-flex flex-column">
                                        <MudText Style="font-size:small;">Sales</MudText>
                                        <MudText Style="font-size:small;">Rp 100.000.000.000</MudText>
                                    </MudPaper>
                                </MudPaper>
                            </MudItem>
                            <MudItem xs="6" md="3" Class="d-flex flex-column">
                                <MudPaper Elevation="0" Class="d-flex flex-grow-1 gap-4">
                                    <MudImage Src="images/Revenue.svg" Elevation="25" Width="32" Height="32" Alt="Swedish Farm House" Class="rounded-lg" />
                                    <MudPaper Elevation="0" Class="flex-initial d-flex flex-column">
                                        <MudText Style="font-size:small;">Revenue</MudText>
                                        <MudText Style="font-size:small;">Rp 100.000.000.000</MudText>
                                    </MudPaper>
                                </MudPaper>
                            </MudItem>
                            <MudItem xs="6" md="3" Class="d-flex flex-column">
                                <MudPaper Elevation="0" Class="d-flex flex-grow-1 gap-4">
                                    <MudImage Src="images/Profit.svg" Elevation="25" Width="32" Height="32" Alt="Swedish Farm House" Class="rounded-lg" />
                                    <MudPaper Elevation="0" Class="flex-initial d-flex flex-column">
                                        <MudText Style="font-size:small;">Profit</MudText>
                                        <MudText Style="font-size:small;">Rp 100.000.000.000</MudText>
                                    </MudPaper>
                                </MudPaper>
                            </MudItem>
                            <MudItem xs="6" md="3" Class="d-flex flex-column">
                                <MudPaper Elevation="0" Class="d-flex flex-grow-1 gap-4">
                                    <MudImage Src="images/Cost.svg" Elevation="25" Width="32" Height="32" Alt="Swedish Farm House" Class="rounded-lg" />
                                    <MudPaper Elevation="0" Class="flex-initial d-flex flex-column">
                                        <MudText Style="font-size:small;">Cost</MudText>
                                        <MudText Style="font-size:small;">Rp 100.000.000.000</MudText>
                                    </MudPaper>
                                </MudPaper>
                            </MudItem>
                        </MudGrid>
                    </MudPaper>
                </MudItem>
                <MudItem xs="12">
                    <MudPaper Elevation="1" Class="pa-4">
                        <MudText><b>Purchase Overview</b></MudText>
                        <MudGrid Class="pt-3">
                            <MudItem xs="6" md="3">
                                <MudPaper Elevation="0" Class="d-flex flex-grow-1 gap-4">
                                    <MudImage Src="images/Sales.svg" Elevation="25" Width="32" Height="32" Alt="Swedish Farm House" Class="rounded-lg" />
                                    <MudPaper Elevation="0" Class="flex-initial d-flex flex-column">
                                        <MudText Style="font-size:small;">Purchase</MudText>
                                        <MudText Style="font-size:small;">Rp 100.000.000.000</MudText>
                                    </MudPaper>
                                </MudPaper>
                            </MudItem>
                            <MudItem xs="6" md="3" Class="d-flex flex-column">
                                <MudPaper Elevation="0" Class="d-flex flex-grow-1 gap-4">
                                    <MudImage Src="images/Cost.svg" Elevation="25" Width="32" Height="32" Alt="Swedish Farm House" Class="rounded-lg" />
                                    <MudPaper Elevation="0" Class="flex-initial d-flex flex-column">
                                        <MudText Style="font-size:small;">Cost</MudText>
                                        <MudText Style="font-size:small;">Rp 100.000.000.000</MudText>
                                    </MudPaper>
                                </MudPaper>
                            </MudItem>
                            <MudItem xs="6" md="3" Class="d-flex flex-column">
                                <MudPaper Elevation="0" Class="d-flex flex-grow-1 gap-4">
                                    <MudImage Src="images/Revenue.svg" Elevation="25" Width="32" Height="32" Alt="Swedish Farm House" Class="rounded-lg" />
                                    <MudPaper Elevation="0" Class="flex-initial d-flex flex-column">
                                        <MudText Style="font-size:small;">Cancel</MudText>
                                        <MudText Style="font-size:small;">Rp 100.000.000.000</MudText>
                                    </MudPaper>
                                </MudPaper>
                            </MudItem>
                            <MudItem xs="6" md="3" Class="d-flex flex-column">
                                <MudPaper Elevation="0" Class="d-flex flex-grow-1 gap-4">
                                    <MudImage Src="images/Profit.svg" Elevation="25" Width="32" Height="32" Alt="Swedish Farm House" Class="rounded-lg" />
                                    <MudPaper Elevation="0" Class="flex-initial d-flex flex-column">
                                        <MudText Style="font-size:small;">Return</MudText>
                                        <MudText Style="font-size:small;">Rp 100.000.000.000</MudText>
                                    </MudPaper>
                                </MudPaper>
                            </MudItem>
                        </MudGrid>
                    </MudPaper>
                </MudItem>
                <MudItem xs="12">
                    <MudPaper Elevation="1" Class="pa-4">
                        <MudText><b>Sales & Purchase</b></MudText>
                        <div>
                            <MudChart ChartType="ChartType.Bar" ChartSeries="@Series" @bind-SelectedIndex="ChartIndex" XAxisLabels="@XAxisLabels" Width="100%" Height="358px"></MudChart>
                        </div>
                    </MudPaper>
                </MudItem>
            </MudGrid>
        </MudItem>
        <MudItem xs="12" sm="4">
            <MudGrid>
                <MudItem xs="12">
                    <MudPaper Elevation="1" Class="pa-4" Height="160">
                        <MudText><b>Inventory Summary</b></MudText>
                        <MudGrid Class="pt-3">
                            <MudItem xs="6">
                                <MudPaper Elevation="0" Class="flex-initial d-flex flex-column align-center gap-1">
                                    <MudImage Src="images/Quantity.svg" Width="32" Height="32" Alt="Swedish Farm House" Class="rounded-lg" />
                                    <MudText Style="font-size:small;">Quantity</MudText>
                                    <MudText Style="font-size:small;">100.000</MudText>
                                </MudPaper>
                            </MudItem>
                            <MudItem xs="6">

                                <MudPaper Elevation="0" Class="flex-initial d-flex flex-column align-center gap-1">
                                    <MudImage Src="images/On the way.svg" Width="32" Height="32" Alt="Swedish Farm House" Class="rounded-lg" />
                                    <MudText Style="font-size:small;">On the way</MudText>
                                    <MudText Style="font-size:small;">200</MudText>
                                </MudPaper>
                            </MudItem>
                        </MudGrid>
                    </MudPaper>
                </MudItem>
                <MudItem xs="12">
                    <MudPaper Elevation="1" Class="pa-4" Height="160">
                        <MudText><b>Product Summary</b></MudText>
                        <MudGrid Class="pt-3">
                            <MudItem xs="6">
                                <MudPaper Elevation="0" Class="flex-initial d-flex flex-column align-center gap-1">
                                    <MudImage Src="images/Suppliers.svg" Width="32" Height="32" Alt="Swedish Farm House" Class="rounded-lg" />
                                    <MudText Style="font-size:small;">Suppliers</MudText>
                                    <MudText Style="font-size:small;">100</MudText>
                                </MudPaper>
                            </MudItem>
                            <MudItem xs="6">

                                <MudPaper Elevation="0" Class="flex-initial d-flex flex-column align-center gap-1">
                                    <MudImage Src="images/Categories.svg" Width="32" Height="32" Alt="Swedish Farm House" Class="rounded-lg" />
                                    <MudText Style="font-size:small;">Categories</MudText>
                                    <MudText Style="font-size:small;">3</MudText>
                                </MudPaper>
                            </MudItem>
                        </MudGrid>
                    </MudPaper>
                </MudItem>
                <MudItem xs="12">
                    <MudPaper Elevation="1" Class="pa-4">
                        <MudPaper Elevation="0" Class="d-flex justify-space-between flex-grow-1 gap-4 mb-3">
                            <MudText><b>Low Quantity Product</b></MudText>
                            <MudLink Href="#">See All</MudLink>
                        </MudPaper>
                        @foreach (var lqp in LowQtyProducts)
                        {
                            <MudPaper Elevation="0" Class="d-flex justify-space-between flex-grow-1 gap-4 mb-4">
                                <MudImage Src="@lqp.ImageUrl" Elevation="25" Width="48" Height="48" Alt="Swedish Farm House" Class="rounded-lg" />
                                <MudPaper Elevation="0" Class="flex-initial d-flex flex-column gap-1" MinWidth="50%">
                                    <MudText>@lqp.Name</MudText>
                                    <MudText Style="font-size:small;">Remaining Quantity: <b>@lqp.Qty</b> </MudText>
                                </MudPaper>
                                <MudPaper Elevation="0">
                                    <MudChip Variant="Variant.Outlined" Color="Color.Secondary">@lqp.StockStatus</MudChip>
                                </MudPaper>
                            </MudPaper>
                        }
                    </MudPaper>
                </MudItem>
            </MudGrid>
        </MudItem>

        <MudItem xs="12" sm="6">
            <MudPaper Elevation="1" Class="pa-4">
                <MudText><b>Order Summary</b></MudText>
                <MudChart ChartType="ChartType.Line" ChartSeries="@OrderChartSeries" @bind-SelectedIndex="OrderChartIndex" XAxisLabels="@XAxisLabels" ChartOptions="@options" Width="100%" Height="348px"></MudChart>
                <MudButton @onclick="RandomizeData">Randomize Data</MudButton>
            </MudPaper>
        </MudItem>

        <MudItem xs="12" sm="6">
            <MudPaper Elevation="1" Class="pa-4">
                <MudPaper Elevation="0" Class="d-flex justify-space-between flex-grow-1 gap-4">
                    <MudText><b>Top Selling Product</b></MudText>
                    <MudLink Href="#">See All</MudLink>
                </MudPaper>
                <MudTable Class="mt-3" Items="@Elements" Hover="true" Breakpoint="Breakpoint.Sm" Loading="@_loading" LoadingProgressColor="Color.Info">
                    <HeaderContent>
                        <MudTh>Name</MudTh>
                        <MudTh>Sold Quantity</MudTh>
                        <MudTh>Remaining Quantity</MudTh>
                        <MudTh>Price</MudTh>
                    </HeaderContent>
                    <RowTemplate>
                        <MudTd DataLabel="Name">@context.Name</MudTd>
                        <MudTd DataLabel="Sold Qty">@context.SoldQty</MudTd>
                        <MudTd DataLabel="Remaining Qty">@context.RemainingQty</MudTd>
                        <MudTd DataLabel="Price">@context.Price</MudTd>
                    </RowTemplate>
                </MudTable>
            </MudPaper>
        </MudItem>

    </MudGrid>
</MudContainer>

@code {
    private class LowQtyProduct
    {
        public string? Name { get; set; }
        public int Qty { get; set; }
        public string? ImageUrl { get; set; }
        public string? StockStatus { get; set; }
    }

    private class TopSellingProduct
    {
        public string? Name { get; set; }
        public int SoldQty { get; set; }
        public int RemainingQty { get; set; }
        public int Price { get; set; }
    }

    private ChartOptions options = new ChartOptions();

    private bool _loading;

    private List<TopSellingProduct> Elements = new List<TopSellingProduct>();
    private List<LowQtyProduct> LowQtyProducts = new List<LowQtyProduct>();

    protected override async Task OnInitializedAsync()
    {

        options.InterpolationOption = InterpolationOption.NaturalSpline;
        options.YAxisFormat = "c2";
        var lowStock = new LowQtyProduct()
            {
                Name = "Madu",
                Qty = 10,
                ImageUrl = "images/Sales.svg",
                StockStatus = "LOW"
            };
        for (int i = 0; i < 5; i++)
        {
            LowQtyProducts.Add(lowStock);

        }
        Elements.Add(new TopSellingProduct()
            {
                Name = "Bakso",
                SoldQty = 99,
                RemainingQty = 133,
                Price = 13000
            });
        Elements.Add(new TopSellingProduct()
            {
                Name = "Mie Ayam",
                SoldQty = 88,
                RemainingQty = 122,
                Price = 12000
            });
        Elements.Add(new TopSellingProduct()
            {
                Name = "Mie Ayam Bakso",
                SoldQty = 77,
                RemainingQty = 111,
                Price = 15000
            });

        Elements.Add(new TopSellingProduct()
            {
                Name = "Es Teh Manis",
                SoldQty = 200,
                RemainingQty = 400,
                Price = 300
            });
        Elements.Add(new TopSellingProduct()
            {
                Name = "Es Teh Manis",
                SoldQty = 200,
                RemainingQty = 400,
                Price = 300
            });
        Elements.Add(new TopSellingProduct()
            {
                Name = "Es Teh Manis",
                SoldQty = 200,
                RemainingQty = 400,
                Price = 300
            });
        Elements.Add(new TopSellingProduct()
            {
                Name = "Es Teh Manis",
                SoldQty = 200,
                RemainingQty = 400,
                Price = 300
            });
    }

    private int ChartIndex = -1; //default value cannot be 0 -> first selectedindex is 0.

    public List<ChartSeries> Series = new List<ChartSeries>()
    {
        new ChartSeries() { Name = "Sales", Data = new double[] { 40, 20, 25, 27, 46, 60, 48, 80, 15 } },
        new ChartSeries() { Name = "Purchase", Data = new double[] { 19, 24, 35, 13, 28, 15, 13, 16, 31 } },
    };
    public string[] XAxisLabels = { "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep" };

    private int OrderChartIndex = -1; //default value cannot be 0 -> first selectedindex is 0.

    public List<ChartSeries> OrderChartSeries = new List<ChartSeries>()
    {
        new ChartSeries() { Name = "Incoming order", Data = new double[] { 55, 65, 70, 65, 70 } },
        new ChartSeries() { Name = "Delivered order", Data = new double[] { 55, 65, 69, 65, 69 } },
    };
    public string[] OrderChartXAxisLabels = { "Jul", "Aug", "Sep", "Okt", "Nov" };

    Random random = new Random();
    public void RandomizeData()
    {
        var new_series = new List<ChartSeries>()
        {
            new ChartSeries() { Name = "Incoming order", Data = new double[5] },
            new ChartSeries() { Name = "Delivered order", Data = new double[5] },
        };
        for (int i = 0; i < 5; i++)
        {
            new_series[0].Data[i] = random.NextDouble() * 100;
            new_series[1].Data[i] = random.NextDouble() * 100;
            if (new_series[1].Data[i] > new_series[0].Data[i])
            {
                new_series[0].Data[i] = new_series[1].Data[i];
            }

        }
        this.OrderChartSeries = new_series;
        StateHasChanged();
    }
}
